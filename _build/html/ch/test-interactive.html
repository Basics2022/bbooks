

<!DOCTYPE html>


<html lang="it" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test interactive pages &#8212; basics-books</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.0/dist/loading-attribute-polyfill.min.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch/test-interactive';</script>
    <link rel="shortcut icon" href="../_static/favicon-sugar.svg"/>
    <link rel="index" title="Indice" href="../genindex.html" />
    <link rel="search" title="Cerca" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="it"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="basics-books - Home"/>
    <script>document.write(`<img src="../_static/logo-dark.svg" class="logo__image only-dark" alt="basics-books - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html"><span class="math notranslate nohighlight">\(\texttt{todo}\)</span> list</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/Basics2022/bbooks-physics-hs/blob/master/ch/test-interactive.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Basics2022/bbooks-physics-hs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repository di origine"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Basics2022/bbooks-physics-hs/edit/master/ch/test-interactive.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Basics2022/bbooks-physics-hs/issues/new?title=Issue%20on%20page%20%2Fch/test-interactive.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Apri un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Scarica questa pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ch/test-interactive.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Scarica il file del taccuino"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/ch/test-interactive.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Scarica il file sorgente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Stampa in PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modalità schermo intero"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Cerca" aria-label="Cerca" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Test interactive pages</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenuti </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Test interactive pages</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-content-in-markdown">Interactive content in MarkDown</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-plots">Interactive plots</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <!--
jupytext:
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  name: python3
  display_name: Python 3
-->
<div class="tex2jax_ignore mathjax_ignore section" id="test-interactive-pages">
<span id="bbooks-test-interactive"></span><h1>Test interactive pages<a class="headerlink" href="#test-interactive-pages" title="Permalink to this heading">#</a></h1>
<p>Some text</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5+10 = 15
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fb2d61a8fa0&gt;]
</pre></div>
</div>
<img alt="../_images/b7cdd8e25af2ad9e4ca4eb08da1e0d1fb85e2993a680b329ee92ded7b9d96759.png" src="../_images/b7cdd8e25af2ad9e4ca4eb08da1e0d1fb85e2993a680b329ee92ded7b9d96759.png" />
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="interactive-content-in-markdown">
<span id="ch-interactivemarkdown"></span><h1>Interactive content in MarkDown<a class="headerlink" href="#interactive-content-in-markdown" title="Permalink to this heading">#</a></h1>
<div class="section" id="plots">
<h2>Plots<a class="headerlink" href="#plots" title="Permalink to this heading">#</a></h2>
<p>In a printed book, graphs can be included as figures. We can do the same in an online book, but we can also do much more. The simplest extension is to not create a figure file, which we then include, but to create the figure from code. The upshot of this approach is that students can see how the figure is made. For example, <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:free_energy_density</span></code> below shows the van der Waals free energy density,</p>
<div class="math notranslate nohighlight" id="equation-vdwfreeenergydensity">
<span id="index-0"></span><span class="eqno">()<a class="headerlink" href="#equation-vdwfreeenergydensity" title="Permalink a questa equazione">#</a></span>\[
f_\mathrm{VdW}(\rho) = k_\mathrm{B} T \rho \left[\ln\left(\frac{\rho}{1-b \rho}\right) - 1\right] - a \rho^2,
\]</div>
<p>combined with the common tangent construction to obtain the densities of coexisting phases.</p>
<div class="cell tag_hide-input tag_remove-output docutils container" id="index-1">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>

<span class="c1"># Global parameters</span>
<span class="n">kbt</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># --&gt; all energy (f, a, ...) in units of k_B T</span>
<span class="n">linear_coefficient</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="c1"># add a term linear in rho to f_vdw for a nicer plot</span>
<span class="c1"># this linear term has no impact on the conditions for phase coexistence</span>

<span class="c1"># Colors</span>
<span class="n">grey</span> <span class="o">=</span> <span class="s1">&#39;#eeeeee&#39;</span> <span class="c1"># light grey fill</span>
<span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;#e96868&#39;</span> <span class="c1"># red line</span>
<span class="n">nucleatn_color</span> <span class="o">=</span> <span class="s1">&#39;#6a8ba4&#39;</span> <span class="c1"># dark blue for nucleation&amp;growth</span>
<span class="n">spinodal_color</span> <span class="o">=</span> <span class="s1">&#39;#BBDEF0&#39;</span> <span class="c1"># light blue for spinodal decomposition</span>

<span class="k">def</span> <span class="nf">f_vdw</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the free energy density for a Van der Waals fluid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">kbt</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">rho</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">rho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">linear_coefficient</span><span class="o">*</span><span class="n">kbt</span><span class="o">*</span><span class="n">rho</span>

<span class="k">def</span> <span class="nf">f_vdw_prime</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the derivative w.r.t. the density rho of the free energy</span>
<span class="sd">    density of a VdW fluid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">kbt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">rho</span><span class="p">))</span> <span class="o">+</span> <span class="n">kbt</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">rho</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">rho</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">rho</span> <span class="o">+</span> <span class="n">linear_coefficient</span><span class="o">*</span><span class="n">kbt</span>

<span class="k">def</span> <span class="nf">conditions_for_coexistence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that should be zero when phases coexist. A vector with</span>
<span class="sd">    one element mu1 - mu2, and one element p1 - p2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rho1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rho2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mu1</span> <span class="o">=</span> <span class="n">f_vdw_prime</span><span class="p">(</span><span class="n">rho1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">mu2</span> <span class="o">=</span> <span class="n">f_vdw_prime</span><span class="p">(</span><span class="n">rho2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rho1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rho2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">mu_deficit</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">-</span> <span class="n">mu2</span>
    <span class="n">p_deficit</span>  <span class="o">=</span> <span class="n">rho1</span><span class="o">*</span><span class="n">mu1</span> <span class="o">-</span> <span class="n">f1</span> <span class="o">-</span> <span class="n">rho2</span><span class="o">*</span><span class="n">mu2</span> <span class="o">+</span> <span class="n">f2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">mu_deficit</span><span class="p">,</span> <span class="n">p_deficit</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">f_mix</span><span class="p">(</span><span class="n">rho_av</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Free energy density for a mixture of gas (density rho1) and liquid (density</span>
<span class="sd">    rho2). The gas and liquid densities (rho1 and rho2) are found numerically.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rhosol</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">conditions_for_coexistence</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
    <span class="n">rho1</span> <span class="o">=</span> <span class="n">rhosol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rho2</span> <span class="o">=</span> <span class="n">rhosol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rho1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">f_vdw</span><span class="p">(</span><span class="n">rho2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rho1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">rho2</span><span class="o">-</span><span class="n">rho1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho_av</span> <span class="o">-</span> <span class="n">rho1</span><span class="p">)</span>

<span class="c1">## Prepare all the graphs that are to be plotted</span>
<span class="c1"># Define the range of densities to plot</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Set the parameters a and b</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Find the densities at which the gas and liquid phases coexist by solving</span>
<span class="c1"># numerically. If you use different a and b you might need to change the</span>
<span class="c1"># guesses, x0.</span>
<span class="n">rhosol</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">conditions_for_coexistence</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>

<span class="c1">## Make the plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># Put axes on the zeros</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Remove label at 0.0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>

<span class="c1"># Plot the graphs</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">f_mix</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Create markers rho1 and rho2</span>
<span class="n">rho1_marker_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">rho1_marker_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">rho1_marker_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho1_marker_x</span><span class="p">,</span> <span class="n">rho1_marker_y</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">rho2_marker_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_vdw</span><span class="p">(</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">rho2_marker_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">rho2_marker_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho2_marker_x</span><span class="p">,</span> <span class="n">rho2_marker_y</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rho_2$&#39;</span><span class="p">)</span>

<span class="c1"># Labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;density $\rho$&#39;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;free energy density $f$&#39;</span><span class="p">)</span>

<span class="c1"># Limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">rho</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>

<span class="c1"># Save graph to load in figure later (special Jupyter Book feature)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;free_energy_density&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="fig-free-energy-density">
<img alt="../_images/1741c4364067fb9f80a7ac7496b706d436b892a01cafdd8c02cfcf0ab415d789.svg" src="../_images/1741c4364067fb9f80a7ac7496b706d436b892a01cafdd8c02cfcf0ab415d789.svg" /><p class="caption"><span class="caption-text">The free energy density (red curve), with a “common tangent construction”
(black straight line), connecting two points with the same slope, by a straight
line with the same slope.</span><a class="headerlink" href="#fig-free-energy-density" title="Link a questa immagine">#</a></p>
</div>
</div>
<div class="section" id="interactive-plots">
<h2>Interactive plots<a class="headerlink" href="#interactive-plots" title="Permalink to this heading">#</a></h2>
<p id="index-2">We can make the plot in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:free_energy_density</span></code> even more useful by making it interactive, letting students see how the plot changes if we change a parameter, <em>without</em> having access in the code. The interactive version is shown in the figure below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">]),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="n">sliders</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">active</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">currentvalue</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;a/b: &quot;</span><span class="p">},</span>
    <span class="n">steps</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="p">)]</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">sliders</span><span class="o">=</span><span class="n">sliders</span><span class="p">,</span>
    <span class="n">legend_title</span><span class="o">=</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Side By Side Subplots&quot;</span><span class="p">)</span>

<span class="n">fig</span>
<span class="c1"># fig.show()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
Cell In[3], line 22
     11 fig.add_trace(
     12     go.Scatter(x=[20, 30, 40], y=[50, 60, 70]),
     13     row=1, col=2
     14 )
     16 sliders = [dict(
     17     active=3,
     18     currentvalue={&quot;prefix&quot;: &quot;a/b: &quot;},
     19     steps=range(5)
     20 )]
---&gt; 22 fig.update_layout(
     23     sliders=sliders,
     24     legend_title=&quot;Legend&quot;,
     25 )
     26 fig.update_layout(height=600, width=800, title_text=&quot;Side By Side Subplots&quot;)
     28 fig

File ~/.local/lib/python3.8/site-packages/plotly/graph_objs/_figure.py:792, in Figure.update_layout(self, dict1, overwrite, **kwargs)
    766 def update_layout(self, dict1=None, overwrite=False, **kwargs) -&gt; &quot;Figure&quot;:
    767     &quot;&quot;&quot;
    768 
    769     Update the properties of the figure&#39;s layout with a dict and/or with
   (...)
    790 
    791     &quot;&quot;&quot;
--&gt; 792     return super(Figure, self).update_layout(dict1, overwrite, **kwargs)

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:1391, in BaseFigure.update_layout(self, dict1, overwrite, **kwargs)
   1367 def update_layout(self, dict1=None, overwrite=False, **kwargs):
   1368     &quot;&quot;&quot;
   1369     Update the properties of the figure&#39;s layout with a dict and/or with
   1370     keyword arguments.
   (...)
   1389         The Figure object that the update_layout method was called on
   1390     &quot;&quot;&quot;
-&gt; 1391     self.layout.update(dict1, overwrite=overwrite, **kwargs)
   1392     return self

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:5131, in BasePlotlyType.update(self, dict1, overwrite, **kwargs)
   5129     with self.figure.batch_update():
   5130         BaseFigure._perform_update(self, dict1, overwrite=overwrite)
-&gt; 5131         BaseFigure._perform_update(self, kwargs, overwrite=overwrite)
   5132 else:
   5133     BaseFigure._perform_update(self, dict1, overwrite=overwrite)

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:3931, in BaseFigure._perform_update(plotly_obj, update_obj, overwrite)
   3925             plotly_obj[key] = plotly_obj[key] + tuple(
   3926                 val[len(plotly_obj[key]) :]
   3927             )
   3928     else:
   3929         # plotly_obj is an empty or uninitialized list for key
   3930         # In this case we accept val as is
-&gt; 3931         plotly_obj[key] = val
   3932 else:
   3933     # Assign non-compound value
   3934     plotly_obj[key] = val

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:5906, in BaseLayoutType.__setitem__(self, prop, value)
   5903 match = self._subplot_re_match(prop)
   5904 if match is None:
   5905     # Set as ordinary property
-&gt; 5906     super(BaseLayoutHierarchyType, self).__setitem__(prop, value)
   5907 else:
   5908     # Set as subplotid property
   5909     self._set_subplotid_prop(prop, value)

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:4864, in BasePlotlyType.__setitem__(self, prop, value)
   4862 # ### Handle compound array property ###
   4863 elif isinstance(validator, (CompoundArrayValidator, BaseDataValidator)):
-&gt; 4864     self._set_array_prop(prop, value)
   4866 # ### Handle simple property ###
   4867 else:
   4868     self._set_prop(prop, value)

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:5345, in BasePlotlyType._set_array_prop(self, prop, val)
   5342 # Import value
   5343 # ------------
   5344 validator = self._get_validator(prop)
-&gt; 5345 val = validator.validate_coerce(val, skip_invalid=self._skip_invalid)
   5347 # Save deep copies of current and new states
   5348 # ------------------------------------------
   5349 curr_val = self._compound_array_props.get(prop, None)

File ~/.local/lib/python3.8/site-packages/_plotly_utils/basevalidators.py:2604, in CompoundArrayValidator.validate_coerce(self, v, skip_invalid)
   2602     res.append(self.data_class(v_el))
   2603 elif isinstance(v_el, dict):
-&gt; 2604     res.append(self.data_class(v_el, skip_invalid=skip_invalid))
   2605 else:
   2606     if skip_invalid:

File ~/.local/lib/python3.8/site-packages/plotly/graph_objs/layout/_slider.py:1156, in Slider.__init__(self, arg, active, activebgcolor, bgcolor, bordercolor, borderwidth, currentvalue, font, len, lenmode, minorticklen, name, pad, steps, stepdefaults, templateitemname, tickcolor, ticklen, tickwidth, transition, visible, x, xanchor, y, yanchor, **kwargs)
   1154 _v = steps if steps is not None else _v
   1155 if _v is not None:
-&gt; 1156     self[&quot;steps&quot;] = _v
   1157 _v = arg.pop(&quot;stepdefaults&quot;, None)
   1158 _v = stepdefaults if stepdefaults is not None else _v

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:4864, in BasePlotlyType.__setitem__(self, prop, value)
   4862 # ### Handle compound array property ###
   4863 elif isinstance(validator, (CompoundArrayValidator, BaseDataValidator)):
-&gt; 4864     self._set_array_prop(prop, value)
   4866 # ### Handle simple property ###
   4867 else:
   4868     self._set_prop(prop, value)

File ~/.local/lib/python3.8/site-packages/plotly/basedatatypes.py:5345, in BasePlotlyType._set_array_prop(self, prop, val)
   5342 # Import value
   5343 # ------------
   5344 validator = self._get_validator(prop)
-&gt; 5345 val = validator.validate_coerce(val, skip_invalid=self._skip_invalid)
   5347 # Save deep copies of current and new states
   5348 # ------------------------------------------
   5349 curr_val = self._compound_array_props.get(prop, None)

File ~/.local/lib/python3.8/site-packages/_plotly_utils/basevalidators.py:2620, in CompoundArrayValidator.validate_coerce(self, v, skip_invalid)
   2618         v = []
   2619     else:
-&gt; 2620         self.raise_invalid_val(v)
   2622 return v

File ~/.local/lib/python3.8/site-packages/_plotly_utils/basevalidators.py:296, in BaseValidator.raise_invalid_val(self, v, inds)
    293             for i in inds:
    294                 name += &quot;[&quot; + str(i) + &quot;]&quot;
--&gt; 296         raise ValueError(
    297             &quot;&quot;&quot;
    298     Invalid value of type {typ} received for the &#39;{name}&#39; property of {pname}
    299         Received value: {v}
    300 
    301 {valid_clr_desc}&quot;&quot;&quot;.format(
    302                 name=name,
    303                 pname=self.parent_name,
    304                 typ=type_str(v),
    305                 v=repr(v),
    306                 valid_clr_desc=self.description(),
    307             )
    308         )

ValueError: 
    Invalid value of type &#39;builtins.range&#39; received for the &#39;steps&#39; property of layout.slider
        Received value: range(0, 5)

    The &#39;steps&#39; property is a tuple of instances of
    Step that may be specified as:
      - A list or tuple of instances of plotly.graph_objs.layout.slider.Step
      - A list or tuple of dicts of string/value properties that
        will be passed to the Step constructor

        Supported dict properties:
            
            args
                Sets the arguments values to be passed to the
                Plotly method set in `method` on slide.
            execute
                When true, the API method is executed. When
                false, all other behaviors are the same and
                command execution is skipped. This may be
                useful when hooking into, for example, the
                `plotly_sliderchange` method and executing the
                API command manually without losing the benefit
                of the slider automatically binding to the
                state of the plot through the specification of
                `method` and `args`.
            label
                Sets the text label to appear on the slider
            method
                Sets the Plotly method to be called when the
                slider value is changed. If the `skip` method
                is used, the API slider will function as normal
                but will perform no API calls and will not bind
                automatically to state updates. This may be
                used to create a component interface and attach
                to slider events manually via JavaScript.
            name
                When used in a template, named items are
                created in the output figure in addition to any
                items the figure already has in this array. You
                can modify these items in the output figure by
                making your own item with `templateitemname`
                matching this `name` alongside your
                modifications (including `visible: false` or
                `enabled: false` to hide it). Has no effect
                outside of a template.
            templateitemname
                Used to refer to a named item in this array in
                the template. Named items from the template
                will be created even without a matching item in
                the input figure, but you can modify one by
                making an item with `templateitemname` matching
                its `name`, alongside your modifications
                (including `visible: false` or `enabled: false`
                to hide it). If there is no template or no
                matching item, this item will be hidden unless
                you explicitly show it with `visible: true`.
            value
                Sets the value of the slider step, used to
                refer to the step programatically. Defaults to
                the slider label if not provided.
            visible
                Determines whether or not this step is included
                in the slider.
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [remove-input]</span>

<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="k">def</span> <span class="nf">f_vdw_doubleprime</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the second derivative of the free energy density for a</span>
<span class="sd">    Van der Waals fluid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">kbt</span><span class="o">/</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">rho</span><span class="p">))</span> <span class="o">+</span> <span class="n">kbt</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">rho</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span>

<span class="n">range_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">27.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1">## Create plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">base_traces</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Number of traces that are always visible</span>

<span class="c1"># Add traces, one for each slider step</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">range_a</span><span class="p">:</span>
    <span class="n">rhosol</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">conditions_for_coexistence</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
    <span class="n">rho_turningpoints</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">f_vdw_doubleprime</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">rhosol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rhosol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;nucleation and growth&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">nucleatn_color</span><span class="p">)))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rhosol</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rhosol</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;nucleation and growth&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">nucleatn_color</span><span class="p">),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rho_turningpoints</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;spinodal decomposition&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">spinodal_color</span><span class="p">)))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">f_vdw</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="p">),</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;VdW fluid&#39;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">f_mix</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">),</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;phase separated&#39;</span><span class="p">))</span>

<span class="n">traces_per_step</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Number of traces per value of a</span>

<span class="c1"># Show the traces for one value of a when loading the plot (initial setup)</span>
<span class="n">active_a_index</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traces_per_step</span><span class="p">):</span>
    <span class="n">curr_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">base_traces</span> <span class="o">+</span> <span class="n">active_a_index</span><span class="o">*</span><span class="n">traces_per_step</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">curr_idx</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Create and add slider</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">range_a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">visarray</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">visarray</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">base_traces</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">base_traces</span>
    <span class="n">curr_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">base_traces</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">traces_per_step</span><span class="p">)</span>
    <span class="n">next_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">base_traces</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">traces_per_step</span><span class="p">)</span>
    <span class="n">visarray</span><span class="p">[</span><span class="n">curr_idx</span><span class="p">:</span><span class="n">next_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">traces_per_step</span>
    <span class="n">step</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;update&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="n">visarray</span><span class="p">}],</span>
        <span class="n">label</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">range_a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="n">sliders</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">active</span><span class="o">=</span><span class="n">active_a_index</span><span class="p">,</span>
    <span class="n">currentvalue</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;a/b: &quot;</span><span class="p">},</span>
    <span class="n">steps</span><span class="o">=</span><span class="n">steps</span>
<span class="p">)]</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">sliders</span><span class="o">=</span><span class="n">sliders</span><span class="p">,</span>
    <span class="n">legend_title</span><span class="o">=</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;density $\rho$&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Update yaxis properties</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;free energy density $f$&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Credit: Examples from Jos Zwanikken’s online book for <a class="reference external" href="http://tnw-nb-open-courses.tudelft.nl/NB2220/">NB2220 Statistical physics for Nanobiology</a>, coded by Lukas de Kam.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ch"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenuti
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Test interactive pages</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-content-in-markdown">Interactive content in MarkDown</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-plots">Interactive plots</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Di basics
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>